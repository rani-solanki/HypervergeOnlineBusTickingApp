{"ast":null,"code":"import _regeneratorRuntime from\"/home/rani/Documents/Red_bus_app/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/rani/Documents/Red_bus_app/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import setAlert from'./aleart';import{BOOKING_FAIL,BOOKING_SUCCESS,TICKETS_FOUND,NO_TICKETS,CANCEL_TICKET,CANNOT_CANCEL}from'./type';export var bookSeats=function bookSeats(busId,userData){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,body,res,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;config={headers:{'Content-Type':'application/json'}};body=JSON.stringify(userData);_context.next=5;return axios.post(\"/api/buses/\".concat(busId,\"/tickets\"),body,config);case 5:res=_context.sent;console.log(res.data);dispatch({type:BOOKING_SUCCESS,payload:res.data});alert(\"Tickets booked succesfully\",\"success\");_context.next=18;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);errors=_context.t0.response.data.errors;console.log(errors);if(errors){errors.forEach(function(error){return dispatch(alert(error.msg,'danger'));});}dispatch({type:BOOKING_FAIL});alert(_context.t0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var getTickets=function getTickets(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{'Content-Type':'application/json'}};_context2.prev=1;_context2.next=4;return axios.get('/api/auth/tickets/ticket',config);case 4:res=_context2.sent;console.log(\"Tickets\",res.data);dispatch({type:TICKETS,payload:res.data});_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);dispatch({type:NO_TICKETS});case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var cancelTicket=function cancelTicket(ticketId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(ticketId);config={headers:{'Content-Type':'application/json'}};try{res=axios.delete(\"/users/user/tickets/ticket/\".concat(ticketId),config);dispatch({type:CANCEL_TICKET,payload:res.data});}catch(err){console.log(err);dispatch({type:CANNOT_CANCEL});}case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};","map":{"version":3,"sources":["/home/rani/Documents/Red_bus_app/Frontend/src/action/Bookseat.js"],"names":["axios","setAlert","BOOKING_FAIL","BOOKING_SUCCESS","TICKETS_FOUND","NO_TICKETS","CANCEL_TICKET","CANNOT_CANCEL","bookSeats","busId","userData","dispatch","config","headers","body","JSON","stringify","post","res","console","log","data","type","payload","alert","errors","response","forEach","error","msg","getTickets","get","TICKETS","cancelTicket","ticketId","delete","err"],"mappings":"6TAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,OACIC,YADJ,CAEIC,eAFJ,CAGIC,aAHJ,CAIIC,UAJJ,CAKIC,aALJ,CAMIC,aANJ,KAOO,QAPP,CASA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,KAAD,CAAQC,QAAR,iGAAqB,iBAAMC,QAAN,6JAEhCC,MAFgC,CAEvB,CACXC,OAAO,CAAE,CACL,eAAgB,kBADX,CADE,CAFuB,CAOhCC,IAPgC,CAOzBC,IAAI,CAACC,SAAL,CAAeN,QAAf,CAPyB,uBAQpBV,CAAAA,KAAK,CAACiB,IAAN,sBAAyBR,KAAzB,aAA0CK,IAA1C,CAAgDF,MAAhD,CARoB,QAQhCM,GARgC,eAStCC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EACAV,QAAQ,CAAC,CACLW,IAAI,CAAEnB,eADD,CAELoB,OAAO,CAAEL,GAAG,CAACG,IAFR,CAAD,CAAR,CAKAG,KAAK,CAAC,4BAAD,CAA+B,SAA/B,CAAL,CAfsC,iFAkBhCC,MAlBgC,CAkBvB,YAAIC,QAAJ,CAAaL,IAAb,CAAkBI,MAlBK,CAmBtCN,OAAO,CAACC,GAAR,CAAYK,MAAZ,EACA,GAAIA,MAAJ,CAAW,CACPA,MAAM,CAACE,OAAP,CAAe,SAAAC,KAAK,QAAIjB,CAAAA,QAAQ,CAACa,KAAK,CAACI,KAAK,CAACC,GAAP,CAAY,QAAZ,CAAN,CAAZ,EAApB,EACH,CACDlB,QAAQ,CAAC,CACLW,IAAI,CAAEpB,YADD,CAAD,CAAR,CAGAsB,KAAK,aAAL,CA1BsC,qEAArB,gEAAlB,CA8BP,MAAO,IAAMM,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,mGAAM,kBAAMnB,QAAN,qIACtBC,MADsB,CACb,CACXC,OAAO,CAAE,CACL,eAAgB,kBADX,CADE,CADa,yCAONb,CAAAA,KAAK,CAAC+B,GAAN,CAAU,0BAAV,CAAsCnB,MAAtC,CAPM,QAOlBM,GAPkB,gBAQxBC,OAAO,CAACC,GAAR,CAAY,SAAZ,CAAuBF,GAAG,CAACG,IAA3B,EACAV,QAAQ,CAAC,CACLW,IAAI,CAAEU,OADD,CAELT,OAAO,CAAEL,GAAG,CAACG,IAFR,CAAD,CAAR,CATwB,mFAcxBV,QAAQ,CAAC,CACLW,IAAI,CAAEjB,UADD,CAAD,CAAR,CAdwB,sEAAN,kEAAnB,CAoBP,MAAO,IAAM4B,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CACxBC,QADwB,kGACX,kBAAMvB,QAAN,qIACTQ,OAAO,CAACC,GAAR,CAAYc,QAAZ,EACMtB,MAFG,CAEM,CACXC,OAAO,CAAE,CACL,eAAgB,kBADX,CADE,CAFN,CAOT,GAAI,CACMK,GADN,CACYlB,KAAK,CAACmC,MAAN,sCAA2CD,QAA3C,EAAuDtB,MAAvD,CADZ,CAEAD,QAAQ,CAAC,CACLW,IAAI,CAAEhB,aADD,CAELiB,OAAO,CAAEL,GAAG,CAACG,IAFR,CAAD,CAAR,CAIH,CAAC,MAAOe,GAAP,CAAY,CACVjB,OAAO,CAACC,GAAR,CAAYgB,GAAZ,EACAzB,QAAQ,CAAC,CACLW,IAAI,CAAEf,aADD,CAAD,CAAR,CAGH,CAlBQ,wDADW,kEAArB","sourcesContent":["import axios from 'axios';\nimport setAlert from './aleart';\nimport {\n    BOOKING_FAIL,\n    BOOKING_SUCCESS,\n    TICKETS_FOUND,\n    NO_TICKETS,\n    CANCEL_TICKET,\n    CANNOT_CANCEL\n} from './type';\n\nexport const bookSeats = (busId, userData) => async dispatch => {\n    try {\n        const config = {\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        }\n        const body = JSON.stringify(userData)\n        const res = await axios.post(`/api/buses/${busId}/tickets`, body, config)\n        console.log(res.data)\n        dispatch({\n            type: BOOKING_SUCCESS,\n            payload: res.data\n        })\n\n        alert(\"Tickets booked succesfully\", \"success\")\n    }\n    catch (err) {\n        const errors = err.response.data.errors;\n        console.log(errors)\n        if (errors){\n            errors.forEach(error => dispatch(alert(error.msg, 'danger')));\n        }\n        dispatch({\n            type: BOOKING_FAIL,\n        })\n        alert(err)\n    }\n}\n\nexport const getTickets = () => async dispatch => {\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    };\n    try {\n        const res = await axios.get('/api/auth/tickets/ticket', config);\n        console.log(\"Tickets\", res.data)\n        dispatch({\n            type: TICKETS,\n            payload: res.data\n        });\n    } catch (err) {\n        dispatch({\n            type: NO_TICKETS\n        });\n    }\n};\n\nexport const cancelTicket = (\n    ticketId) => async dispatch =>{\n        console.log(ticketId)\n        const config = {\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        };\n        try {\n            const res = axios.delete(`/users/user/tickets/ticket/${ticketId}`, config);\n            dispatch({\n                type: CANCEL_TICKET,\n                payload: res.data\n            });\n        } catch (err) {\n            console.log(err);\n            dispatch({\n                type: CANNOT_CANCEL\n            });\n        }\n    };\n"]},"metadata":{},"sourceType":"module"}