{"ast":null,"code":"import _regeneratorRuntime from\"/home/rani/Documents/Red_bus_app/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/rani/Documents/Red_bus_app/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import setAlert from'./aleart';import setAuthToken from'../utils/isAuthantication';import{USER_LOADED,AUTH_ERROR,REGISTER_FAIL,REGISTER_SUCCESS,LOGIN_SUCCESS,LOGIN_FAIL,LOGOUT}from'../action/type';// // LOAD USER\nexport var loadUser=function loadUser(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.token){setAuthToken(localStorage.token);}_context.prev=1;_context.next=4;return axios.get('/api/auth/Auth');case 4:res=_context.sent;dispatch({type:USER_LOADED,payload:res.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:AUTH_ERROR});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};// Ragister user\nexport var register=function register(_ref2){var name=_ref2.name,email=_ref2.email,password=_ref2.password;return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,body,res,errors;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({name:name,email:email,password:password});_context2.prev=2;_context2.next=5;return axios.post('/api/users/signup',body,config);case 5:res=_context2.sent;dispatch({type:REGISTER_SUCCESS,payload:res.data});alert('user Ragister SuccesFully','danger');dispatch(loadUser());_context2.next=17;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](2);errors=_context2.t0.response.data.err;alert(\"user is Aleardy exit\");if(errors){errors.forEach(function(error){return dispatch(setAlert(error.msg,'danger'));});}dispatch({type:REGISTER_FAIL});case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[2,11]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};// Ragister user\nexport var adminregister=function adminregister(_ref4){var name=_ref4.name,email=_ref4.email,password=_ref4.password,isAdmin=_ref4.isAdmin;return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,body,res,errors;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({name:name,email:email,password:password,isAdmin:isAdmin});_context3.prev=2;_context3.next=5;return axios.post('http://localhost:1900/api/admins/signup',body,config);case 5:res=_context3.sent;console.log(res);dispatch({type:REGISTER_SUCCESS,payload:res.data});alert(\"Admin Ragister succesfully\");_context3.next=17;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](2);errors=_context3.t0.response.data.err;alert(\"user is Aleardy exit\");if(errors){errors.forEach(function(error){return dispatch(setAlert(error.msg,'danger'));});}dispatch({type:REGISTER_FAIL});case 17:case\"end\":return _context3.stop();}}},_callee3,null,[[2,11]]);}));return function(_x3){return _ref5.apply(this,arguments);};}();};// Login User//\nexport var login=function login(email,password){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var config,body,res,errors;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context4.prev=2;_context4.next=5;return axios.post('http://localhost:1900/api/auth/login',body,config);case 5:res=_context4.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});console.log(\"discpatch from action\",dispatch);alert(\"User is Login Succesfully\");dispatch(loadUser());_context4.next=17;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](2);errors=_context4.t0.response.data.errors;if(errors){alert(\"Invalid credentials\");errors.forEach(function(error){return dispatch(setAlert(error.msg,'danger'));});}dispatch({type:LOGIN_FAIL});case 17:case\"end\":return _context4.stop();}}},_callee4,null,[[2,12]]);}));return function(_x4){return _ref6.apply(this,arguments);};}();};// Admin Login//\nexport var adminlogin=function adminlogin(email,password){return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var config,body,res,errors;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context5.prev=2;console.log(email,password);_context5.next=6;return axios.post('http://localhost:1900/api/adminauth/login',body,config);case 6:res=_context5.sent;console.log(res);dispatch({type:LOGIN_SUCCESS,payload:res.data});alert(\"Admin is Login Succesfully\");dispatch(loadUser());_context5.next=18;break;case 13:_context5.prev=13;_context5.t0=_context5[\"catch\"](2);errors=_context5.t0.response.data.errors;if(errors){alert(\"Invalid credentials\");errors.forEach(function(error){return dispatch(setAlert(error.msg,'danger'));});}dispatch({type:LOGIN_FAIL});case 18:case\"end\":return _context5.stop();}}},_callee5,null,[[2,13]]);}));return function(_x5){return _ref7.apply(this,arguments);};}();};export var logout=function logout(){return function(dispatch){console.log(\"logout\");dispatch({type:LOGOUT});};};","map":{"version":3,"sources":["/home/rani/Documents/Red_bus_app/Frontend/src/action/auth.js"],"names":["axios","setAlert","setAuthToken","USER_LOADED","AUTH_ERROR","REGISTER_FAIL","REGISTER_SUCCESS","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","loadUser","dispatch","localStorage","token","get","res","type","payload","data","register","name","email","password","config","headers","body","JSON","stringify","post","alert","errors","response","err","forEach","error","msg","adminregister","isAdmin","console","log","login","adminlogin","logout"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport setAlert from './aleart';\nimport setAuthToken from '../utils/isAuthantication';\n\nimport {\n    USER_LOADED,\n    AUTH_ERROR,\n    REGISTER_FAIL,\n    REGISTER_SUCCESS,\n    LOGIN_SUCCESS,\n    LOGIN_FAIL,\n    LOGOUT\n} from '../action/type';\n\n// // LOAD USER\nexport const loadUser = () => async dispatch => {\n    if (localStorage.token) {\n        setAuthToken(localStorage.token);\n    }\n    try {\n        const res = await axios.get('/api/auth/Auth');\n        dispatch({\n            type: USER_LOADED,\n            payload: res.data\n        });\n    } catch (err) {\n        dispatch({\n            type: AUTH_ERROR\n        });\n    }\n};\n\n// Ragister user\nexport const register = ({ name, email, password }) => async dispatch =>{\n    const config = {\n        headers: { \"Content-Type\": \"application/json\" }\n    }\n    const body = JSON.stringify({ name, email, password });\n    try {\n        const res = await axios.post('/api/users/signup', body, config);\n        dispatch({\n            type: REGISTER_SUCCESS,\n            payload: res.data\n        });\n        alert('user Ragister SuccesFully', 'danger')\n        dispatch(loadUser());\n    } catch (err) {\n        const errors = err.response.data.err;\n        alert(\"user is Aleardy exit\")\n        if (errors) {\n            errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n        }\n        dispatch({\n            type: REGISTER_FAIL\n        })\n    }\n}\n\n// Ragister user\nexport const adminregister = ({ name, email, password, isAdmin }) => async dispatch => {\n    const config = {\n        headers: { \"Content-Type\": \"application/json\" }\n    }\n    const body = JSON.stringify({ name, email, password, isAdmin });\n    try {\n        const res = await axios.post('http://localhost:1900/api/admins/signup', body, config);\n        console.log(res)\n        dispatch({\n            type: REGISTER_SUCCESS,\n            payload: res.data\n        });\n\n        alert(\"Admin Ragister succesfully\")\n    } catch (err) {\n        const errors = err.response.data.err;\n        alert(\"user is Aleardy exit\")\n        if (errors) {\n            errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n        }\n        dispatch({\n            type: REGISTER_FAIL\n        })\n    }\n}\n\n// Login User//\nexport const login = (email, password) => async dispatch => {\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n    const body = JSON.stringify({ email, password });\n    try {\n        const res = await axios.post('http://localhost:1900/api/auth/login', body, config);\n        dispatch({\n            type: LOGIN_SUCCESS,\n            payload: res.data\n        });\n        console.log(\"discpatch from action\",dispatch)\n        alert(\"User is Login Succesfully\")\n        dispatch(loadUser());\n    } catch (err) {\n        const errors = err.response.data.errors;\n        if (errors) {\n            alert(\"Invalid credentials\")\n            errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n        }\n        dispatch({\n            type: LOGIN_FAIL\n        });\n    }\n};\n\n// Admin Login//\nexport const adminlogin = (email, password) => async dispatch => {\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n\n    const body = JSON.stringify({ email, password });\n\n    try {\n        console.log(email,password)\n        const res = await axios.post('http://localhost:1900/api/adminauth/login', body, config);\n        console.log(res)\n        dispatch({\n            type: LOGIN_SUCCESS,\n            payload: res.data\n        });\n        alert(\"Admin is Login Succesfully\")\n        dispatch(loadUser());\n    } catch (err) {\n        const errors = err.response.data.errors;\n        if (errors) {\n            alert(\"Invalid credentials\")\n            errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n        }\n        dispatch({\n            type: LOGIN_FAIL\n        });\n    }\n};\n\nexport const logout = () => dispatch => {\n    console.log(\"logout\")\n    dispatch({ type: LOGOUT });\n}\n\n\n"]},"metadata":{},"sourceType":"module"}